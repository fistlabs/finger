finger [![Build Status](https://travis-ci.org/golyshevd/finger.svg?branch=master)](https://travis-ci.org/golyshevd/finger)
=========

Среверный роутер для http-запросов. 

#[finger/Router](Router.js)
##```Router([params])```
Конструктор роутера. На вход принимает опциональный объект параметров, которые являются умолчательными опциями для всех маршрутов роутера. Собственные опции маршрутов имеют более высокий приоритет.
```js
var router = new Router({
    //  Включает игнорирование регистра символов в uri запроса для всех маршрутов
    ignoreCase: true,
    //  При компилировании регулярного выражения в начало не будет 
    //  установлен якорь начала строки
    doNotMatchStart: true,
    // При компилировании регулярного выражения в конец не будет 
    //  установлен якорь конца строки
    doNotMathEnd: true
});
```

по умолчанию все опции отключены

##```Router.prototype.addRoute(pattern[, data])```
Добавляет в роутер маршрут, соответствующий заданному паттерну.
Паттерн состоит из одной обязательной части и двух необязательных. Обязательной частью паттерня является непостредственно шаблон ```uri``` запроса
```js
var pattern = '/news/(<post>/)';
```
Шаблон может иметь не только статические части, но и именованные параметры, а также необязательные для матчинга части.
Если при успешном матчинге запроса необходимо получить некоторые части ```uri```, то необходимо выделить их в параметры. Параметры указываются в угловых скобках. Необязательные части заключаются в круглые скобки. Это значит, что вышеприведенный шаблон соответствует как ```/news/``` так и ```/news/my-post/```

Также паттерн может специфицировать метод запроса для ```uri```.
```js
var pattern = 'GET /news/(<post>)';
```
Если не указать метод, то умолчательным методом запроса будет ```GET```. Также маршруты для ```GET``` запросов матчатся на ```HEAD``` запросы.

Непосредственно в паттерне запроса можно указать некоторые опции, которые являются частью синтаксиса паттернов. Опции передаются как флаги в ругулярных выражениях. Поддерживаются флаги ```e``` и ```s```. При компилировании паттерна флаги раскриваются в параметры. ```e``` интерпретируется как ```doNotMatchEnd: true```, а ```s``` как ```doNotMatchStart: true```. Чтобы установить опцию в ```false``` (например чтобы переопределить дефолтное поведение роутера) необходимо устанавливать флаги в верхнем регистре. Например ```E``` ~ ```doNotmathEnd: false```.
```js
var router = new Router({
    doNotMatchEnd: true
});
router.addRoute('GET /images/<fileName>.jpg Es');
router.addRoute('GET /downloads/');
```
Вторым аргументом в этот метод передается объект ```data``` (опционально). Этот объект може содержать любые данные, ассоцированне с маршрутом, но одно поле имеет особое значение: ```data.name```. Если планируется пользоваться методом [getRoute](#routerprototypegetroutename), для того чтобы получить доступ к api маршрута, то необходимо его указать, иначе ```name``` будет сгенерирован случайным образом.

Метод возвращает объект только что созданного маршрута.
##```Router.prototype.getRoute(name)```
Возвращает объект маршрута по имени.
```js
var router = new Router()
router.addRoute('GET /', {
    name: 'index'
});
var indexRoute = router.getRoute('index');
```
##```Router.prototype.find(verb, pathname)```
Принимает на вход метод запроса и ```pathname``` (без query!) и возвращает один из нескольких вариантов ответа.
Метод может вернуть 4 разных варианта данных, которые стоит интерпретировать по-разному. 
Если роутер вернул ```null```, это значит что нет ресурса для заданного ```uri``` (404).
Если роутер вернул пустой массив, это значит что в роутере нет ни одного маршрута для заданного метода запроса (501).
Если роутер вернул не пустой массив, то это значит что данный ресурс недоступен данным методом, но доступен одним из тех что в массиве. Из этого масива можно сформировать заголовок Allow для ответа 405.
В остальных случаях роутер возвращает объект с двумя полями: ```route``` и ```match```. ```route``` - это сам объект маршрута, а ```match``` - результат матчинга ```uri``` на шаблон. Если в шаблоне были указаны параметры, то в этом объекте будут их значения.
#[finger/route/Route](route/Route.js)
Объект маршрута роутера. маршуты можно создавать вручную для кастомного использования, но не рекомендуется. Интерес представляет метод ```Route.prototype.build```, с помощью которого можно из паттерна построить ```uri```, передав параметры.
```js
var router = new Router();
router.addRoute('GET /news/(<post>/)', {
    name: 'news'
});

router.getRoute('news').build(); // /news/
router.getRoute('news').build({post: 'foo'}); // /news/foo/
router.getRoute('news').build({post: 'foo', bar: 'baz'}); // /news/foo/?bar=baz
router.getRoute('news').build({foo: 'bar', baz: 'zot'}); // /news/?foo=bar&baz=zot
```
